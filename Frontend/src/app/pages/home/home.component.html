
<div class="home-container">
  @if (!currentUser) {
    <div class="welcome-section">
      <h1>Finora</h1>
    </div>
  }

  @if (currentUser) {
    <div class="user-dashboard">
    <div class="header-section">
      <h1>Welcome, {{ currentUser.firstName }} {{ currentUser.lastName }}!</h1>
      <div class="action-buttons">
        <a routerLink="/transfer" class="transfer-btn">Transfer Money</a>
      </div>
    </div>

    <div class="balance-section">
      <h2>Balance</h2>
      <div class="balance-amount">
        {{ userBalance?.balance | currency }}
      </div>
    </div>

    <div class="transactions-section">
      <h2>Transaction History</h2>
      
      @if (loading) {
        <div class="loading">
          Loading transactions...
        </div>
      }
      
      @if (!loading && transactions.length === 0) {
        <div class="no-transactions">
          No transactions found.
        </div>
      }
      
      @if (!loading && transactions.length > 0) {
        <div class="transactions-table-container">
        <table class="transactions-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>From Account</th>
              <th>To Account</th>
              <th>Amount</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            @for (transaction of transactions; track transaction.id) {
              <tr>
              <td>{{ transaction.transactionDate | date:'short' }}</td>
              <td class="account-id">{{ transaction.fromBankAccountId }}</td>
              <td class="account-id">{{ transaction.toBankAccountId }}</td>
              <td class="amount" 
              [class.positive]="transaction.amount > 0 && (transaction.toBankAccountId === currentUser!.bankAccountId || !transaction.toBankAccountId)" 
              [class.negative]="transaction.amount < 0 || (transaction.fromBankAccountId === currentUser!.bankAccountId && transaction.toBankAccountId)">
                @if (transaction.toBankAccountId && transaction.toBankAccountId !== currentUser!.bankAccountId) {
                  -{{ transaction.amount | currency }}
                } @else {
                  {{ transaction.amount | currency }}
                }
              </td>
              <td>{{ transaction.description || '-' }}</td>
              </tr>
            }
          </tbody>
        </table>
        
        @if (totalPages > 1) {
          <div class="pagination">
            <button 
              class="pagination-btn" 
              [disabled]="currentPage === 1" 
              (click)="previousPage()">
              Previous
            </button>
            
            @for (page of getPageNumbers(); track page) {
              <button 
                class="pagination-btn page-number"
                [class.active]="page === currentPage"
                (click)="goToPage(page)">
                {{ page }}
              </button>
            }
            
            <button 
              class="pagination-btn" 
              [disabled]="currentPage === totalPages" 
              (click)="nextPage()">
              Next
            </button>
          </div>
          
            <div class="pagination-info">
              Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ getEndIndex() }} 
              of {{ totalTransactions }} transactions
            </div>
          }
        </div>
      }
    </div>
  </div>
  }
</div>